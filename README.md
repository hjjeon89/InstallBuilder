# InstallerBuilder

C# 프로젝트를 위한 Windows 설치 파일(.exe)을 간편하게 생성하는 GUI 애플리케이션입니다.

## 주요 기능

- **자동 빌드 및 패키징**: .csproj 파일을 지정하면 자동으로 프로젝트를 빌드하고 설치 파일을 생성합니다.
- **다양한 프로젝트 지원**:
    - .NET Framework, .NET Core, .NET 5+ 프로젝트를 자동 감지하여 처리합니다.
    - DevExpress 등 `licenses.licx` 파일이 포함된 프로젝트를 지원합니다.
- **다양한 설치 파일 형식 지원**:
    - **Inno Setup (주력)**: 전문적인 설치 UI와 옵션(업그레이드, 삭제 등)을 제공하는 설치 파일(.exe)을 생성합니다.
    - **WiX Toolset (실험적)**: MSI 형식의 설치 파일을 생성합니다.
    - **7-Zip SFX (대체)**: Inno Setup, WiX가 없는 환경을 위해 자체 풀림 압축 파일(.exe)을 생성합니다.
- **사용자 정의 기능**:
    - 버전 정보, 기본 설치 경로를 직접 설정할 수 있습니다.
    - 별도의 DLL, 설정 파일(.config, .json) 등을 설치 패키지에 포함할 수 있습니다.
    - 파일/폴더 구조를 유지한 채로 특정 위치에 복사할 수 있습니다.
    - 설치 및 제거 시 추가 파일의 덮어쓰기/삭제 여부를 선택하는 옵션을 포함할 수 있습니다.

## 사용 방법

1. `InstallerBuilder.exe`를 실행합니다.
2. **프로젝트 경로**: 설치 파일을 만들 `.csproj` 파일 경로를 입력하거나 '찾아보기' 버튼으로 선택합니다. (드래그 앤 드롭 지원)
3. **출력 경로**: 생성된 설치 파일이 저장될 폴더를 지정합니다. (기본값: `D:\Installer`)
4. **옵션 설정**:
    - **버전**: 설치 파일의 버전을 `1.0.0` 형식으로 입력합니다.
    - **추가 파일**: 설치본에 포함할 DLL이나 설정 파일이 있다면 '추가' 버튼이나 드래그 앤 드롭으로 목록에 추가하고, 설치될 위치를 지정합니다.
    - **설치 옵션**: 기본 설치 경로, 제거 시 파일 삭제 여부 등을 설정합니다.
5. **설치파일 생성**: '설치파일 생성' 버튼을 클릭하면 로그 창에 빌드 및 패키징 과정이 표시됩니다.
6. **완료**: 출력 경로에 `[프로젝트명]_[버전]_Setup.exe` 형식의 파일이 생성됩니다.

## 기술적 특징

### 빌드 전략

- **프로젝트 타입 감지**: `.csproj` 파일 내용을 분석하여 .NET Framework와 .NET Core/5+ 프로젝트를 구분합니다.
- **빌드 도구 자동 선택**:
    - **MSBuild**: .NET Framework 프로젝트 또는 `licenses.licx` 파일이 포함된 모든 프로젝트(.NET Core 포함)를 빌드할 때 사용됩니다. 이는 라이선스 컴파일러(LC.exe)가 `dotnet build`에서 지원되지 않기 때문입니다.
    - **dotnet build**: 그 외의 .NET Core/5+ 프로젝트를 빌드할 때 사용됩니다.

### 설치 파일 생성

- **Inno Setup**: 시스템에 Inno Setup이 감지되면, 상세한 설정이 포함된 `.iss` 스크립트를 동적으로 생성하여 컴파일합니다. 이전 버전 자동 제거, 바탕화면 바로가기 생성, 추가 파일 처리 등 복잡한 설치 로직을 수행합니다.
- **WiX Toolset**: Inno Setup이 없고 WiX Toolset이 감지되면 `.wxs` 스크립트를 생성하여 `.msi` 패키지를 만듭니다.
- **7-Zip SFX / ZIP**: 위 두 도구가 모두 없으면, 7-Zip을 이용해 자체 풀림 압축 파일을 만들거나 단순 ZIP 파일로 압축하여 휴대용(portable) 버전을 제공합니다.

## 개발 이력 (Git Log)

*참고: 커밋 메시지의 한글 인코딩 문제로 일부 내용이 깨져 보일 수 있습니다.*

```
* 0fd66c1 8 days ago, hjjeon1925: Version 1.1.3 ...
* 1706abc 8 days ago, hjjeon1925: ...로그(log)...
* 6126185 7 weeks ago, vcw2023: icon 추가 (chatgpt가 만듦)
* cc57f45 7 weeks ago, vcw2023: 경로가 없는 경우...
* 07d7849 7 weeks ago, vcw2023: 1.1.2 inno setup 미설치...
* 4ab93d9 8 weeks ago, hjjeon1925: 버전정보 및 install 정보 추가...
* bfb9e6a 8 weeks ago, hjjeon1925: initial commit
* 91064d0 8 weeks ago, hjjeon1925: git 무시목록 설정
```

## 시스템 요구사항

### 실행 환경
- Windows 10 이상
- .NET 9.0 Runtime (또는 상위 버전)

### 설치 파일 생성을 위한 도구 (선택)
- **Inno Setup 5 또는 6**: 주 기능인 `.exe` 설치 파일을 생성하기 위해 권장됩니다. (설치되지 않은 경우 프로그램에서 설치 안내)
- **Visual Studio 2019 / 2022**: .NET Framework 프로젝트 빌드를 위해 MSBuild가 필요합니다.
- **WiX Toolset v3**: `.msi` 설치 파일을 생성하려면 필요합니다.
- **7-Zip**: `.zip` 또는 SFX `.exe` 파일을 생성하려면 필요합니다.
